<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>dist\assist.html</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/ColorSwitcher.html">ColorSwitcher</a></li>
                                <li><a href="../classes/Comment.html">Comment</a></li>
                                <li><a href="../classes/comment.js_anonymous.html">comment.js_anonymous</a></li>
                                <li><a href="../classes/Data.html">Data</a></li>
                                <li><a href="../classes/Global.html">Global</a></li>
                                <li><a href="../classes/helpInfo.js_anonymous.html">helpInfo.js_anonymous</a></li>
                                <li><a href="../classes/IO.html">IO</a></li>
                                <li><a href="../classes/io.js_anonymous.html">io.js_anonymous</a></li>
                                <li><a href="../classes/JQuery.html">JQuery</a></li>
                                <li><a href="../classes/ManualMarkup.html">ManualMarkup</a></li>
                                <li><a href="../classes/manualMarkup.js_anonymous.html">manualMarkup.js_anonymous</a></li>
                                <li><a href="../classes/markupPopup.js_anonymous.html">markupPopup.js_anonymous</a></li>
                                <li><a href="../classes/navbar.js_anonymous.html">navbar.js_anonymous</a></li>
                                <li><a href="../classes/Popup.html">Popup</a></li>
                                <li><a href="../classes/Regex.html">Regex</a></li>
                                <li><a href="../classes/Summary.html">Summary</a></li>
                                <li><a href="../classes/summary.js_anonymous.html">summary.js_anonymous</a></li>
                                <li><a href="../classes/switcher.js_anonymous.html">switcher.js_anonymous</a></li>
                                <li><a href="../classes/tagRegex.js_anonymous.html">tagRegex.js_anonymous</a></li>
                                <li><a href="../classes/UI.html">UI</a></li>
                                <li><a href="../classes/ui.js_anonymous.html">ui.js_anonymous</a></li>
                                <li><a href="../classes/Util.html">Util</a></li>
                                <li><a href="../classes/utilities.js_anonymous.html">utilities.js_anonymous</a></li>
                                <li><a href="../classes/WebDictionary.html">WebDictionary</a></li>
                                <li><a href="../classes/webDictionary.js_anonymous.html">webDictionary.js_anonymous</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/comment.js.html">comment.js</a></li>
                                <li><a href="../modules/data.js.html">data.js</a></li>
                                <li><a href="../modules/helpInfo.js.html">helpInfo.js</a></li>
                                <li><a href="../modules/io.js.html">io.js</a></li>
                                <li><a href="../modules/markupPopup.js.html">markupPopup.js</a></li>
                                <li><a href="../modules/markus.js.html">markus.js</a></li>
                                <li><a href="../modules/navbar.js.html">navbar.js</a></li>
                                <li><a href="../modules/reference.js.html">reference.js</a></li>
                                <li><a href="../modules/summary.js.html">summary.js</a></li>
                                <li><a href="../modules/switcher.js.html">switcher.js</a></li>
                                <li><a href="../modules/tagRegex.js.html">tagRegex.js</a></li>
                                <li><a href="../modules/TestModule.html">TestModule</a></li>
                                <li><a href="../modules/ui.js.html">ui.js</a></li>
                                <li><a href="../modules/utilities.js.html">utilities.js</a></li>
                                <li><a href="../modules/webDictionary.js.html">webDictionary.js</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: dist\assist.html</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&lt;div class=&quot;web-dictionary-container&quot; data-spy=&quot;affix&quot; data-offset-top=&quot;0&quot; style=&quot;padding-right:0px;padding-left:0px;&quot;&gt;
  &lt;div id=&quot;buttonsRow&quot; style=&quot;padding-bottom:10px;&quot;&gt;
    &lt;button data-markus-default=&quot;true&quot; type=&quot;button&quot; class=&quot;btn btn-sm btn-danger switcher&quot; color-switcher-class=&quot;fullName&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;click to change color&quot;&gt;姓名&lt;/button&gt;
    &lt;button data-markus-default=&quot;true&quot; type=&quot;button&quot; class=&quot;btn btn-sm btn-warning switcher&quot; color-switcher-class=&quot;partialName&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;click to change color&quot;&gt;別名&lt;/button&gt;
    &lt;button data-markus-default=&quot;true&quot; type=&quot;button&quot; class=&quot;btn btn-sm btn-success switcher&quot; color-switcher-class=&quot;timePeriod&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;click to change color&quot;&gt;時間&lt;/button&gt;
    &lt;button data-markus-default=&quot;true&quot; type=&quot;button&quot; class=&quot;btn btn-sm btn-primary switcher&quot; color-switcher-class=&quot;placeName&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;click to change color&quot;&gt;地名&lt;/button&gt;
    &lt;button data-markus-default=&quot;true&quot; type=&quot;button&quot; class=&quot;btn btn-sm btn-info switcher&quot; color-switcher-class=&quot;officialTitle&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;click to change color&quot;&gt;官職&lt;/button&gt;
    &lt;!-- &lt;button id=&quot;showModalBtn&quot; class=&quot;btn btn-sm btn-primary&quot; style=&quot;opacity:0&quot;&gt;Automated markup options&lt;/button&gt; --&gt;

    &lt;button type=&quot;button&quot; id=&quot;editDocBtn&quot; class=&quot;btn btn-sm&quot; data-container=&quot;body&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;full text edit mode&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-edit&quot;&gt;&lt;/span&gt;&lt;/button&gt;
    &lt;button id=&quot;showHelpModalBtn&quot; class=&quot;btn btn-sm&quot; data-container=&quot;body&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;icon info&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-info-sign&quot;&gt;&lt;/span&gt;&lt;/button&gt;
    &lt;button id=&quot;showSummaryModalBtn&quot; class=&quot;btn btn-sm&quot; data-container=&quot;body&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;tag summary&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-list-alt&quot;&gt;&lt;/span&gt;&lt;/button&gt;
    &lt;button id=&quot;showParagraphModalBtn&quot; class=&quot;btn btn-sm&quot; data-container=&quot;body&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;show paragraph&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-indent-left&quot;&gt;&lt;/span&gt;&lt;/button&gt;
    &lt;button id=&quot;showManageTagModalBtn&quot; style=&quot;display:none&quot; class=&quot;btn btn-sm&quot; data-container=&quot;body&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;manage tag&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-tags&quot;&gt;&lt;/span&gt;&lt;/button&gt;
    &lt;button id=&quot;showManageTabModalBtn&quot; style=&quot;display:none&quot; class=&quot;btn btn-sm&quot; data-container=&quot;body&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;manage web reference&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-folder-close&quot;&gt;&lt;/span&gt;&lt;/button&gt;
    &lt;!-- &lt;button id=&quot;showSplitPassageModalBtn&quot; class=&quot;btn btn-sm&quot; data-container=&quot;body&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;Split passage by tag&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-pause&quot;&gt;&lt;/span&gt;&lt;/button&gt; --&gt;
    &lt;button id=&quot;showGotoModalBtn&quot; class=&quot;btn btn-sm&quot; data-container=&quot;body&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;go to passage&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-plane&quot;&gt;&lt;/span&gt;&lt;/button&gt;
    &lt;button id=&quot;alignmentBtn&quot; class=&quot;btn btn-sm&quot; data-container=&quot;body&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;chaning alignment&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-align-left&quot;&gt;&lt;/span&gt;&lt;/button&gt;
    &lt;button id=&quot;displayHiddenBtn&quot; class=&quot;btn btn-sm&quot; data-container=&quot;body&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;Show / hide hidden Character&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-sunglasses&quot;&gt;&lt;/span&gt;&lt;/button&gt;
    &lt;!-- &lt;button id=&quot;showManageReferenceModalBtn&quot; class=&quot;btn btn-sm&quot; data-container=&quot;body&quot; data-toggle=&quot;tooltip&quot; data-placement=&quot;auto&quot; title=&quot;manage reference&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-book&quot;&gt;&lt;/span&gt;&lt;/button&gt; --&gt;

  &lt;/div&gt;
  &lt;ul class=&quot;nav nav-tabs&quot;&gt;
    &lt;li&gt;&lt;a class=&quot;web-dictionary-tab&quot; web-dictionary-name=&quot;cbdb&quot;&gt;CBDB&lt;/a&gt;&lt;/li&gt;
    &lt;!-- &lt;li&gt;&lt;a class=&quot;web-dictionary-tab&quot; web-dictionary-name=&quot;chgis&quot;&gt;CHGIS&lt;/a&gt;&lt;/li&gt; --&gt;
    &lt;li&gt;&lt;a class=&quot;web-dictionary-tab&quot; web-dictionary-name=&quot;chgis&quot;&gt;TGAZ&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a class=&quot;web-dictionary-tab&quot; web-dictionary-name=&quot;zdic&quot;&gt;ZDict&lt;/a&gt;&lt;/li&gt;
    &lt;li class=&quot;active&quot;&gt;&lt;a class=&quot;web-dictionary-tab&quot; web-dictionary-name=&quot;wiki&quot;&gt;Wikipedia&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a class=&quot;web-dictionary-tab&quot; web-dictionary-name=&quot;wiki8&quot;&gt;医学百科&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a class=&quot;web-dictionary-tab&quot; web-dictionary-name=&quot;ddbcPerson&quot;&gt;DDBC Person&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a class=&quot;web-dictionary-tab&quot; web-dictionary-name=&quot;ddbcPlace&quot;&gt;DDBC place&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a class=&quot;web-dictionary-tab&quot; web-dictionary-name=&quot;ddbcGlossaries&quot;&gt;DDBC Glossary&lt;/a&gt;&lt;/li&gt;
    &lt;!-- &lt;li&gt;&lt;a href=&quot;#settings&quot; data-toggle=&quot;tab&quot;&gt;Settings&lt;/a&gt;&lt;/li&gt; --&gt;
  &lt;/ul&gt;
  &lt;div style=&quot;width:100%&quot;&gt;
    &lt;div style=&quot;padding-top:0px&quot;&gt;
      &lt;div class=&quot;item web-dictionary&quot; web-dictionary-name=&quot;cbdb&quot; web-dictionary-search=&quot;searchCBDB&quot; style=&quot;display:none&quot;&gt;

        &lt;div class=&quot;input-group input-group-sm&quot; style=&quot;width:inherit;padding-top:10px;padding-bottom:10px&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;Search&lt;/span&gt;
          &lt;input type=&quot;text&quot; class=&quot;form-control web-dictionary-input&quot; placeholder=&quot;Search name or cbdb ID&quot;&gt;&lt;/input&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;&lt;a class=&quot;web-dictionary-exportURL&quot; target=&quot;webDictionary&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-new-window&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;
        &lt;/div&gt;
        &lt;div id=&quot;cbdbIDRef&quot; class=&quot;btn-group btn-group-justified web-dictionary-button&quot; data-toggle=&quot;buttons&quot;&gt;

        &lt;/div&gt;
        &lt;center &gt;&lt;div class=&quot;web-dictionary-spinHolder&quot; &gt;&lt;/div&gt;&lt;/center&gt;
        &lt;iframe class=&quot;web-dictionary-iframe&quot; frameBorder=&quot;0&quot; src=&quot;&quot; width=&quot;100%&quot; height=&quot;700px&quot;&gt;&lt;/iframe&gt;
      &lt;/div&gt;
      &lt;div class=&quot;item web-dictionary&quot; web-dictionary-name=&quot;chgis&quot; web-dictionary-src=&quot;chgis.html?n={value}&quot; _web-dictionary-src=&quot;http://chgis.hmdc.harvard.edu/engine_basic.php?utfname={value}&quot; web-dictionary-exportURL=&quot;http://maps.cga.harvard.edu/tgaz/placename?n={value}&quot; web-dictionary-param=&quot;{value}&quot; style=&quot;display:none&quot;&gt;
      &lt;style&gt;.banner a {display:none;} &lt;/style&gt;

        &lt;div class=&quot;input-group input-group-sm&quot; style=&quot;width:inherit;padding-top:10px;padding-bottom:10px&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;Search&lt;/span&gt;
          &lt;input type=&quot;text&quot; class=&quot;form-control web-dictionary-input&quot; placeholder=&quot;Search place name&quot;&gt;&lt;/input&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;&lt;a class=&quot;web-dictionary-exportURL&quot; target=&quot;webDictionary&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-new-window&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;
        &lt;/div&gt;
        &lt;center &gt;&lt;div class=&quot;web-dictionary-spinHolder&quot; &gt;&lt;/div&gt;&lt;/center&gt;
        &lt;iframe class=&quot;web-dictionary-iframe&quot; frameBorder=&quot;0&quot; src=&quot;&quot; width=&quot;100%&quot; height=&quot;700px&quot;&gt;&lt;/iframe&gt;
      &lt;/div&gt;
      &lt;div class=&quot;item web-dictionary&quot; web-dictionary-name=&quot;zdic&quot; web-dictionary-src=&quot;http://www.zdic.net/search/?c=3&amp;q={value}&quot;
       web-dictionary-param=&quot;{value}&quot; style=&quot;display:none&quot;&gt;
        &lt;div class=&quot;input-group input-group-sm&quot; style=&quot;width:inherit;padding-top:10px;padding-bottom:10px&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;Search&lt;/span&gt;
          &lt;input type=&quot;text&quot; class=&quot;form-control web-dictionary-input&quot; placeholder=&quot;Search here&quot; &gt;&lt;/input&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;&lt;a class=&quot;web-dictionary-exportURL&quot; target=&quot;webDictionary&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-new-window&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;
        &lt;/div&gt;
        &lt;center &gt;&lt;div class=&quot;web-dictionary-spinHolder&quot; &gt;&lt;/div&gt;&lt;/center&gt;
        &lt;iframe class=&quot;web-dictionary-iframe&quot; frameBorder=&quot;0&quot; src=&quot;&quot; width=&quot;100%&quot; height=&quot;700px&quot;&gt;&lt;/iframe&gt;
      &lt;/div&gt;
      &lt;div class=&quot;item web-dictionary&quot; web-dictionary-name=&quot;wiki&quot; web-dictionary-src=&quot;http://zh.m.wikipedia.org/wiki/{value}&quot;
      web-dictionary-exportURL=&quot;http://zh.wikipedia.org/wiki/{value}&quot; web-dictionary-param=&quot;{value}&quot; &gt;
        &lt;div class=&quot;input-group input-group-sm&quot; style=&quot;width:inherit;padding-top:10px;padding-bottom:10px&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;Search&lt;/span&gt;
          &lt;input type=&quot;text&quot; class=&quot;form-control web-dictionary-input&quot; placeholder=&quot;Search here&quot; &gt;&lt;/input&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;&lt;a class=&quot;web-dictionary-exportURL&quot; target=&quot;webDictionary&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-new-window&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;
        &lt;/div&gt;
        &lt;center &gt;&lt;div class=&quot;web-dictionary-spinHolder&quot;&gt;&lt;/div&gt;&lt;/center&gt;

        &lt;iframe class=&quot;web-dictionary-iframe&quot; frameBorder=&quot;0&quot; src=&quot;&quot; width=&quot;100%&quot; height=&quot;700px&quot;&gt;&lt;/iframe&gt;
      &lt;/div&gt;
      &lt;div class=&quot;item web-dictionary&quot; web-dictionary-name=&quot;wiki8&quot; web-dictionary-src=&quot;http://mobile.wiki8.com/search?q={value}&amp;d=5&amp;ie=t&amp;mobile=true&quot; web-dictionary-exportURL=&quot;http://www.wiki8.com/search?q={value}&amp;d=5&amp;ie=t&amp;mobile=true&quot; web-dictionary-param=&quot;{value}&quot; style=&quot;display:none&quot;&gt;
        &lt;div class=&quot;input-group input-group-sm&quot; style=&quot;width:inherit;padding-top:10px;padding-bottom:10px&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;Search&lt;/span&gt;
          &lt;input type=&quot;text&quot; class=&quot;form-control web-dictionary-input&quot; placeholder=&quot;Search here&quot; &gt;&lt;/input&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;&lt;a class=&quot;web-dictionary-exportURL&quot; target=&quot;webDictionary&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-new-window&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;
        &lt;/div&gt;

        &lt;center &gt;&lt;div class=&quot;web-dictionary-spinHolder&quot;&gt;&lt;/div&gt;&lt;/center&gt;

        &lt;iframe class=&quot;web-dictionary-iframe&quot; frameBorder=&quot;0&quot; src=&quot;&quot; width=&quot;100%&quot; height=&quot;700px&quot;&gt;&lt;/iframe&gt;
      &lt;/div&gt;
      &lt;div class=&quot;item web-dictionary&quot; web-dictionary-name=&quot;ddbcPerson&quot; web-dictionary-search=&quot;searchByID&quot; web-dictionary-src=&quot;http://authority.dila.edu.tw/person/search.php?per={value}&quot; web-dictionary-id-src=&quot;http://authority.dila.edu.tw/person/search.php?aid={value}&quot; web-dictionary-param=&quot;{value}&quot; web-dictionary-id-regex=&quot;A\d+&quot; style=&quot;display:none&quot;&gt;
        &lt;div class=&quot;input-group input-group-sm&quot; style=&quot;width:inherit;padding-top:10px;padding-bottom:10px&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;Search&lt;/span&gt;
          &lt;input type=&quot;text&quot; class=&quot;form-control web-dictionary-input&quot; placeholder=&quot;Search here&quot; &gt;&lt;/input&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;&lt;a class=&quot;web-dictionary-exportURL&quot; target=&quot;webDictionary&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-new-window&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;
        &lt;/div&gt;
        &lt;div class=&quot;btn-group btn-group-justified web-dictionary-button IDRef&quot; data-toggle=&quot;buttons&quot;&gt;

        &lt;/div&gt;
        &lt;center &gt;&lt;div class=&quot;web-dictionary-spinHolder&quot;&gt;&lt;/div&gt;&lt;/center&gt;

        &lt;iframe class=&quot;web-dictionary-iframe&quot; frameBorder=&quot;0&quot; src=&quot;&quot; width=&quot;100%&quot; height=&quot;700px&quot;&gt;&lt;/iframe&gt;
      &lt;/div&gt;
      &lt;div class=&quot;item web-dictionary&quot; web-dictionary-name=&quot;ddbcPlace&quot; web-dictionary-search=&quot;searchByID&quot; _web-dictionary-id-src=&quot;http://authority.dila.edu.tw/place/search.php?code={value}&quot; web-dictionary-id-src=&quot;ddbcPlace.html?q={value}&quot;
      _web-dictionary-src=&quot;http://authority.dila.edu.tw/place/search.php?ml={value}&quot;
      web-dictionary-src=&quot;ddbcPlace.html?q={value}&quot; web-dictionary-id-regex=&quot;PL\d+&quot;   web-dictionary-param=&quot;{value}&quot; web-dictionary-exportURL=&quot;http://authority.dila.edu.tw/place/search.php?ml={value}&quot; style=&quot;display:none&quot;&gt;
        &lt;div class=&quot;input-group input-group-sm&quot; style=&quot;width:inherit;padding-top:10px;padding-bottom:10px&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;Search&lt;/span&gt;
          &lt;input type=&quot;text&quot; class=&quot;form-control web-dictionary-input&quot; placeholder=&quot;Search here&quot; &gt;&lt;/input&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;&lt;a class=&quot;web-dictionary-exportURL&quot; target=&quot;webDictionary&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-new-window&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;
        &lt;/div&gt;
        &lt;div class=&quot;btn-group btn-group-justified web-dictionary-button IDRef&quot; data-toggle=&quot;buttons&quot;&gt;

        &lt;/div&gt;
        &lt;center &gt;&lt;div class=&quot;web-dictionary-spinHolder&quot;&gt;&lt;/div&gt;&lt;/center&gt;

        &lt;iframe class=&quot;web-dictionary-iframe&quot; frameBorder=&quot;0&quot; src=&quot;&quot; width=&quot;100%&quot; height=&quot;700px&quot;&gt;&lt;/iframe&gt;
      &lt;/div&gt;
      &lt;div class=&quot;item web-dictionary&quot; web-dictionary-name=&quot;ddbcGlossaries&quot; web-dictionary-src=&quot;ddbc.html?q={value}&quot; web-dictionary-exportURL=&quot;http://buddhistinformatics.dila.edu.tw/glossaries/search.php?op=search&amp;text={value}&quot; web-dictionary-param=&quot;{value}&quot; style=&quot;display:none&quot;&gt;
        &lt;div class=&quot;input-group input-group-sm&quot; style=&quot;width:inherit;padding-top:10px;padding-bottom:10px&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;Search&lt;/span&gt;
          &lt;input type=&quot;text&quot; class=&quot;form-control web-dictionary-input&quot; placeholder=&quot;Search here&quot; &gt;&lt;/input&gt;
          &lt;span class=&quot;input-group-addon&quot;&gt;&lt;a class=&quot;web-dictionary-exportURL&quot; target=&quot;webDictionary&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-new-window&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;
        &lt;/div&gt;
        &lt;center &gt;&lt;div class=&quot;web-dictionary-spinHolder&quot;&gt;&lt;/div&gt;&lt;/center&gt;

        &lt;iframe class=&quot;web-dictionary-iframe&quot; frameBorder=&quot;0&quot; src=&quot;&quot; width=&quot;100%&quot; height=&quot;700px&quot;&gt;&lt;/iframe&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;modal fade&quot; id=&quot;gotoModal&quot; tabindex=&quot;-1&quot; role=&quot;dialog&quot; aria-labelledby=&quot;myModalLabel&quot; aria-hidden=&quot;true&quot; data-backdrop=&quot;_static&quot;&gt;
  &lt;div class=&quot;modal-dialog&quot;&gt;
    &lt;div class=&quot;modal-content&quot;&gt;
      &lt;!-- &lt;div class=&quot;modal-header&quot;&gt;
        &lt;h4 class=&quot;modal-title&quot;&gt;Select dynasty range&lt;/h4&gt;
      &lt;/div&gt; --&gt;
      &lt;div class=&quot;modal-body&quot;&gt;
        &lt;div class=&quot;form-inline&quot;&gt;
          &lt;div class=&quot;form-group&quot;&gt;
            &lt;label for=&quot;GOTO&quot;&gt;go to passage &lt;/label&gt;
            &lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;passage number&quot;&gt;
          &lt;/div&gt;
          &lt;button class=&quot;btn btn-default&quot;&gt;Go&lt;/button&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;&lt;!-- /.modal-content --&gt;
  &lt;/div&gt;&lt;!-- /.modal-dialog --&gt;
&lt;/div&gt;
&lt;div class=&quot;modal fade&quot; id=&quot;manageTabModal&quot; tabindex=&quot;-1&quot; role=&quot;dialog&quot; aria-labelledby=&quot;myModalLabel&quot; aria-hidden=&quot;true&quot; data-backdrop=&quot;_static&quot;&gt;
  &lt;div class=&quot;modal-dialog&quot;&gt;
    &lt;div class=&quot;modal-content&quot;&gt;
      &lt;!-- &lt;div class=&quot;modal-header&quot;&gt;
        &lt;h4 class=&quot;modal-title&quot;&gt;Select dynasty range&lt;/h4&gt;
      &lt;/div&gt; --&gt;
      &lt;div class=&quot;modal-body&quot;&gt;
         &lt;ul class=&quot;nav nav-tabs&quot;&gt;
          &lt;li&gt;&lt;a&gt;CBDB &lt;input web-dictionary-name=&quot;cbdb&quot; data-markus-action=&quot;display&quot; type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;/input&gt;&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a&gt;TGAZ &lt;input web-dictionary-name=&quot;chgis&quot; data-markus-action=&quot;display&quot; type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;/input&gt;&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a&gt;ZDict &lt;input web-dictionary-name=&quot;zdic&quot; data-markus-action=&quot;display&quot; type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;/input&gt;&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a&gt;Wikipedia &lt;input web-dictionary-name=&quot;wiki&quot; data-markus-action=&quot;display&quot; type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;/input&gt;&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a&gt;医学百科 &lt;input web-dictionary-name=&quot;wiki8&quot; data-markus-action=&quot;display&quot; type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;/input&gt;&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a&gt;DDBC Person &lt;input web-dictionary-name=&quot;ddbcPerson&quot; data-markus-action=&quot;display&quot; type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;/input&gt;&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a&gt;DDBC place &lt;input web-dictionary-name=&quot;ddbcPlace&quot; data-markus-action=&quot;display&quot; type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;/input&gt;&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a&gt;DDBC Glossary &lt;input web-dictionary-name=&quot;ddbcGlossaries&quot; data-markus-action=&quot;display&quot; type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;/input&gt;&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/div&gt;
    &lt;/div&gt;&lt;!-- /.modal-content --&gt;
  &lt;/div&gt;&lt;!-- /.modal-dialog --&gt;
&lt;/div&gt;
&lt;div class=&quot;modal fade&quot; id=&quot;splitPassageModal&quot; tabindex=&quot;-1&quot; role=&quot;dialog&quot; aria-labelledby=&quot;myModalLabel&quot; aria-hidden=&quot;true&quot; data-backdrop=&quot;_static&quot;&gt;
  &lt;div class=&quot;modal-dialog&quot;&gt;
    &lt;div class=&quot;modal-content&quot;&gt;
      &lt;div class=&quot;modal-body&quot;&gt;

      &lt;/div&gt;
    &lt;/div&gt;&lt;!-- /.modal-content --&gt;
  &lt;/div&gt;&lt;!-- /.modal-dialog --&gt;
&lt;/div&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  $(&quot;#showSplitPassageModalBtn&quot;).on(&quot;click&quot;,function(){
    $(&quot;#splitPassageModal .modal-body&quot;).contents().remove();
    $(&quot;#splitPassageModal .modal-body&quot;).append(Object.keys(markus.tag).join(&quot;&lt;br/&gt;&quot;));
    $(&quot;#splitPassageModal&quot;).modal(&quot;show&quot;);
  });
  $(&quot;#showManageTabModalBtn&quot;).on(&quot;click&quot;,function(){
    $(&quot;#manageTabModal&quot;).modal(&quot;show&quot;);
  });
  $(&quot;#gotoModal button&quot;).on(&quot;click&quot;,function(event){
    $(&quot;span[id=&#x27;passage&quot;+$(&quot;#gotoModal input&quot;).val()+&quot;&#x27;]&quot;).goto();
    $(&quot;#gotoModal&quot;).modal(&quot;hide&quot;);
  });

  $(&#x27;#gotoModal&#x27;).on(&#x27;shown.bs.modal&#x27;, function (e) {
    $(&quot;#gotoModal input&quot;).focus();
  });

  $(&quot;#showGotoModalBtn&quot;).on(&quot;click&quot;,function(){
    $(&quot;#gotoModal&quot;).modal(&quot;show&quot;);
  });

  $(&quot;#alignmentBtn&quot;).on(&quot;click&quot;,function(){
    direction = $(&quot;.doc pre&quot;).attr(&quot;dir&quot;) || &quot;auto&quot;;

    switch (direction){
      case &quot;ltr&quot;:
        direction = &quot;auto&quot;;
        break;
      case &quot;auto&quot;:
        direction = &quot;rtl&quot;;
        break;
      case &quot;rtl&quot;:
        direction = &quot;ltr&quot;;
        break;
      default:
        direction = &quot;auto&quot;;
    }
    $(&quot;.doc pre&quot;).attr(&quot;dir&quot;,direction);

  });

  // $(&quot;#removeHiddenBtn&quot;).on(&quot;click&quot;,function(){
  //   $(&quot;.doc pre .EOL&quot;).text(&quot;\n&quot;);
  //   $(&quot;.doc pre .space&quot;).text(&quot; &quot;);
  //   $(&quot;.doc pre .hiddenChar&quot;).contents().unwrap();
  // });


 function SelectText(event, element) {
    // console.log(&quot;selectText&quot;);
    var range, selection;
    $(&quot;.doc pre&quot;).focus();
    if (document.body.createTextRange &amp;&amp; element.nodeName == &#x27;SPAN&#x27;) {
      range = document.body.createTextRange();
      range.moveToElementText(element);
      range.select();
    } else if (window.getSelection) {
      selection = window.getSelection();
      range = document.createRange();
      range.selectNodeContents(element);
      selection.removeAllRanges();
      selection.addRange(range);
    }
    var evt = (event) ? event : window.event;
    if (evt.stopPropagation) evt.stopPropagation();
    if (evt.cancelBubble != null) evt.cancelBubble = true;
    return false;
  }

  function insertTextAtCursor(text) {
      var sel, range, html;
      sel = window.getSelection();
      range = sel.getRangeAt(0);
      range.deleteContents();
      var textNode = document.createElement(&#x27;span&#x27;);
      textNode.textContent = text;
      switch(text){
        case &quot;·&quot;:
          textNode.className = &quot;space hiddenChar&quot;;
          break;
        case &quot;\t&quot;:
           textNode.className = &quot;tab hiddenChar&quot;;
           break;
        case &quot;¬&quot;:
           textNode.className = &quot;EOL hiddenChar&quot;;
           break;
      }

      textNode.setAttribute(&quot;contenteditable&quot;,false);
      textNode.setAttribute(&quot;unselectable&quot;,&quot;on&quot;);
      textNode.setAttribute(&quot;onclick&quot;,&quot;SelectText(event, this);&quot;);


      range.insertNode(textNode);
      range.setStartAfter(textNode);
      sel.removeAllRanges();
      sel.addRange(range);
  }


  $(&quot;#displayHiddenBtn&quot;).on(&quot;click&quot;,function(){

    showHidden = $(this).attr(&#x27;showHidden&#x27;) || $(&quot;.doc pre .hidden&quot;).length === 0;
    showHidden = Boolean(showHidden == &#x27;true&#x27;);
    // console.log(showHidden);
    if (showHidden){
          $(&quot;.doc pre&quot;).contents().filter(function(){
            return this.nodeType === 3;
          }).each(function(){
            this.data = this.data.replace(/ /g,&#x27;|·|&#x27;);
            this.data = this.data.replace(/\t/g,&#x27;|—|&#x27;);
            this.data = this.data.replace(/\n/g,&#x27;|¬|&#x27;);
          });
          $(&quot;.doc pre&quot;).contents().filter(function(){
            return this.nodeType !== 3;
          }).each(function(){
              $(this).contents().filter(function(){
              return this.nodeType === 3;
            }).each(function(){
              this.data = this.data.replace(/ /g,&#x27;|·|&#x27;);
              this.data = this.data.replace(/\t/g,&#x27;|—|&#x27;);
              this.data = this.data.replace(/\n/g,&#x27;|¬|&#x27;);
            });
          });

          $(&quot;.doc pre&quot;).html($(&quot;.doc pre&quot;).html().replace(/\|·\|/g, &quot;&lt;span class=&#x27;space hiddenChar&#x27;&gt;·&lt;/span&gt;&quot;).replace(/\|—\|/g,&quot;&lt;span class=&#x27;tab hiddenChar&#x27;&gt;\t&lt;/span&gt;&quot;)
            .replace(/\|¬\|/g,&quot;&lt;span class=&#x27;hiddenChar EOL&#x27;&gt;¬&lt;/span&gt;&quot;));

          $(&quot;.doc pre .hiddenChar&quot;).on(&quot;click&quot;,function(event){
            SelectText(event,$(this).element);
          });
          $(&quot;.doc pre .hiddenChar&quot;).attr(&quot;contenteditable&quot;,&quot;false&quot;);
          $(&quot;.doc pre .hiddenChar&quot;).attr(&quot;unselectable&quot;,&quot;on&quot;);


    } else {
      // console.log(&quot;not hidden&quot;)
      $(&quot;.doc pre .EOL&quot;).text(&quot;\n&quot;);
      $(&quot;.doc pre .space&quot;).text(&quot; &quot;);
      $(&quot;.doc pre .hiddenChar&quot;).contents().unwrap();

    }

    // console.log($(this).attr(&#x27;showHidden&#x27;))
    $(this).attr(&#x27;showHidden&#x27;,!showHidden);
    // console.log($(this).attr(&#x27;showHidden&#x27;))



});


  $(&#x27;#manageTabModal [data-markus-action=&quot;display&quot;]&#x27;).change(function() {
    console.log($(this).is(&quot;:checked&quot;));
    var web_dictionary_name = $(this).attr(&quot;web-dictionary-name&quot;);
    if($(this).is(&quot;:checked&quot;)) {
      $(&quot;.web-dictionary-container li&quot;).has(&quot;a[web-dictionary-name=&#x27;&quot;+web_dictionary_name+&quot;&#x27;]&quot;).show();
      $(&quot;.web-dictionary-container div.web-dictionary[web-dictionary-name=&#x27;&quot;+$(this).attr(&quot;web-dictionary-name&quot;)+&quot;&#x27;]&quot;).show();
    }else{
      $(&quot;.web-dictionary-container li&quot;).has(&quot;a[web-dictionary-name=&#x27;&quot;+web_dictionary_name+&quot;&#x27;]&quot;).hide();
      $(&quot;.web-dictionary-container div.web-dictionary[web-dictionary-name=&#x27;&quot;+$(this).attr(&quot;web-dictionary-name&quot;)+&quot;&#x27;]&quot;).hide();
    }
    $($(&quot;.web-dictionary-container li a:visible&quot;)[0]).trigger(&quot;click&quot;);

  });
  $(&#x27;#manageTabModal input[web-dictionary-name=&quot;wiki8&quot;],input[web-dictionary-name=&quot;ddbcPerson&quot;],input[web-dictionary-name=&quot;ddbcPlace&quot;],input[web-dictionary-name=&quot;ddbcGlossaries&quot;]&#x27;).trigger(&quot;click&quot;);

  $.getJSON(&quot;/auth/profile_info&quot;, function(result) {
      if (result[&quot;name&quot;]) {
          $(&quot;#showManageTabModalBtn&quot;).show();
          $(&quot;#showManageTagModalBtn&quot;).show();
      } else {
        $(&quot;#showManageTabModalBtn&quot;).hide();
        $(&quot;#showManageTagModalBtn&quot;).hide();
      }


  }).fail(function() {
      $(&quot;#showManageTabModalBtn&quot;).hide();
      $(&quot;#showManageTagModalBtn&quot;).hide();
  });
  var gotolistener = new window.keypress.Listener(document.getElementById(&quot;gotoModal&quot;));
  gotolistener.simple_combo(&quot;enter&quot;, function() {
      // console.log(&quot;enter&quot;);
      $(&quot;#gotoModal button&quot;).trigger(&quot;click&quot;);
  });

  var eventMethod = window.addEventListener ? &quot;addEventListener&quot; : &quot;attachEvent&quot;;
  var eventer = window[eventMethod];
  var messageEvent = eventMethod == &quot;attachEvent&quot; ? &quot;onmessage&quot; : &quot;message&quot;;

  // Listen to message from child window
  eventer(messageEvent,function(e) {
      var key = e.message ? &quot;message&quot; : &quot;data&quot;;
      var data = e[key];
      console.log(data);
      if ($(&quot;.doc .selected&quot;).length &gt; 0){
        $(&quot;.doc .selected&quot;).trigger(&quot;click&quot;);
        if ($(&quot;#cbdbIdPopoverContent input[type=&#x27;text&#x27;]&quot;).is(&#x27;:visible&#x27;)){
          $(&quot;#cbdbIdPopoverContent input[type=&#x27;text&#x27;]&quot;).val(data);
        }
      }
      //run function//
  },false);

$(&quot;#editDocBtn&quot;).on(&quot;click&quot;,function(){
    console.log(&quot;click&quot;);

    var editable = $(&quot;#editDocBtn&quot;).hasClass(&quot;btn-danger&quot;);

    if (editable) {
      $(&quot;#editDocBtn&quot;).removeClass(&quot;btn-danger&quot;);
      $(&quot;.doc&quot;).removeClass(&quot;edit&quot;);
      editable = false;
    }else {
      $(&quot;#editDocBtn&quot;).addClass(&quot;btn-danger&quot;);
      $(&quot;.doc&quot;).addClass(&quot;edit&quot;);
      editable = true;
    }


    if (!editable){
      $(&quot;.doc pre div,br&quot;).prepend(&quot;\n&quot;);
      // $(&quot;.doc pre br&quot;).prepend(&quot;\n&quot;);
      $(&quot;.doc div,br&quot;).contents().unwrap();
      // $(&quot;.doc br&quot;).contents().unwrap();
      $(&quot;.doc pre&quot;).html($(&quot;.doc pre&quot;).html());

      if ($(&quot;.doc .passage&quot;).length &gt; 0){
        $(&quot;.doc .passage&quot;).contents().unwrap();
        startParagraphMarkup();
        markus.comment.startAddingCommentHolder();
      }

      // texts = $(&quot;.doc&quot;).text().replace(/(\r*\n)+/g,&quot;\n&quot;).split(&quot;\n&quot;);
      // Clipper.setTexts(texts);

    }
    if (editable){
      markus.ui.listener.stop_listening();
    } else {
      markus.ui.listener.listen();
    }
    console.log(editable);


    $(&quot;.doc pre&quot;).attr(&quot;contenteditable&quot;,&quot;&quot;+ editable);
  });

$(document).on(&#x27;keydown&#x27;,&quot;.doc pre&quot;, function(event) {
    showingHidden = $(&quot;.doc pre .hiddenChar&quot;).length &gt; 0 || !Boolean($(&quot;#displayHiddenBtn&quot;).attr(&quot;showHidden&quot;));
    if (!showingHidden) {
      return true;
    }
      EditableDiv = $(this).element;
      var ignoreKey;
      var key = event.keyCode || event.charCode;
      if (!window.getSelection) return;
      var selection = window.getSelection();
      var focusNode = selection.focusNode,
        anchorNode = selection.anchorNode;
        console.log(key);
        switch(key) {
            case 9: //Tab
                insertTextAtCursor(&#x27;\t&#x27;);
                event.preventDefault();
                return false;
            case 13: //Enter
                insertTextAtCursor(&#x27;¬&#x27;);
                event.preventDefault();
                return false;
            case 32: //space
                insertTextAtCursor(&#x27;·&#x27;);
                event.preventDefault();
                return false;
        }


      if (!anchorNode) return

      if (anchorNode.nodeName.toLowerCase() != &#x27;#text&#x27;) {
       if (anchorOffset &lt; anchorNode.childNodes.length)
         anchorNode = anchorNode.childNodes[anchorOffset]
       else {
         while (!anchorNode.nextSibling) anchorNode = anchorNode.parentNode // this might step out of EditableDiv to &quot;justincase&quot; comment node
         anchorNode = anchorNode.nextSibling
       }
       anchorOffset = 0
      }

      function backseek() {

       while ((anchorOffset == 0) &amp;&amp; (anchorNode != EditableDiv)) {

         if (anchorNode.previousSibling) {
           if (anchorNode.previousSibling.nodeName.toLowerCase() == &#x27;#text&#x27;) {
             if (anchorNode.previousSibling.nodeValue.length == 0)
               anchorNode.parentNode.removeChild(anchorNode.previousSibling)
             else {
               anchorNode = anchorNode.previousSibling
               anchorOffset = anchorNode.nodeValue.length
             }
           } else if ((anchorNode.previousSibling.offsetWidth == 0) &amp;&amp; (anchorNode.previousSibling.offsetHeight == 0))
             anchorNode.parentNode.removeChild(anchorNode.previousSibling)

           else {
             anchorNode = anchorNode.previousSibling

             while ((anchorNode.lastChild) &amp;&amp; (anchorNode.nodeName.toUpperCase() != &#x27;SPAN&#x27;)) {

               if ((anchorNode.lastChild.offsetWidth == 0) &amp;&amp; (anchorNode.lastChild.offsetHeight == 0))
                 anchorNode.removeChild(anchorNode.lastChild)

               else if (anchorNode.lastChild.nodeName.toLowerCase() != &#x27;#text&#x27;)
                 anchorNode = anchorNode.lastChild

               else if (anchorNode.lastChild.nodeValue.length == 0)
                 anchorNode.removeChild(anchorNode.lastChild)

               else {
                 anchorNode = anchorNode.lastChild
                 anchorOffset = anchorNode.nodeValue.length
                   //break              //don&#x27;t need to break, textnode has no children
               }
             }
             break
           }
         } else
           while (((anchorNode = anchorNode.parentNode) != EditableDiv) &amp;&amp; !anchorNode.previousSibling) {}
       }
      }

      if (key == 8) { //backspace
         if (!selection.isCollapsed) {

           try {
             document.createElement(&quot;select&quot;).size = -1
           } catch (e) { //kludge for IE when 2+ SPANs are back-to-back adjacent

             if (anchorNode.nodeName.toUpperCase() == &#x27;SPAN&#x27;) {
               backseek()
               if (anchorNode.nodeName.toUpperCase() == &#x27;SPAN&#x27;) {
                 var k = document.createTextNode(&quot; &quot;) // doesn&#x27;t work here between two spans.  IE makes TWO EMPTY textnodes instead !
                 anchorNode.parentNode.insertBefore(k, anchorNode) // this works
                 anchorNode.parentNode.insertBefore(anchorNode, k) // simulate &quot;insertAfter&quot;
               }
             }
           }


         } else {
           backseek()

           if (anchorNode == EditableDiv) {
             ignoreKey = true
           } else if (anchorNode.nodeName.toUpperCase() == &#x27;SPAN&#x27;) {
             SelectText(event, anchorNode)
             ignoreKey = true
           } else if ((anchorNode.nodeName.toLowerCase() == &#x27;#text&#x27;) &amp;&amp; (anchorOffset &lt;= 1)) {

             var prev, anchorNodeSave = anchorNode,
               anchorOffsetSave = anchorOffset
             anchorOffset = 0
             backseek()
             if (anchorNode.nodeName.toUpperCase() == &#x27;SPAN&#x27;) prev = anchorNode
             anchorNode = anchorNodeSave
             anchorOffset = anchorOffsetSave

             if (prev) {
               if (anchorOffset == 0)
                 SelectEvent(prev)

               else {
                 var r = document.createRange()
                 selection.removeAllRanges()

                 if (anchorNode.nodeValue.length &gt; 1) {
                   r.setStart(anchorNode, 0)
                   selection.addRange(r)
                   anchorNode.deleteData(0, 1)
                 }
                 else {
                   for (var i = 0, p = prev.parentNode; true; i++)
                     if (p.childNodes[i] == prev) break
                   r.setStart(p, ++i)
                   selection.addRange(r)
                   anchorNode.parentNode.removeChild(anchorNode)
                 }
               }
               ignoreKey = true
             }
           }
         }
      }
      /**
       * @module TestModule
       */
      // if (ignoreKey) {
      //  var evt = event || window.event;
      //  if (evt.stopPropagation) evt.stopPropagation();
      //  evt.preventDefault();
      //  return false;
      // }

    });

&lt;/script&gt;

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
